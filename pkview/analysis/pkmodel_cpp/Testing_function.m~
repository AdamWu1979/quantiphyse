% Example matlab function for calling the c++ (mex) curve fitting procedure and plotting the output
% Benjamin Irving
%
% 1)An example curve is input along with example parameters
% 
%
%
%
%

R1=3.7;
R2 = 4.8;
dce_flip_angle = 12;
dce_TR = 0.0041;
dce_TE= 0.0018;



t=[0, 0.1583, 0.3167, 0.4750, 0.6333, 0.7917, 0.9500,1.1083,...
            1.2667, 1.4250, 1.5833, 1.7417, 1.9000, 2.0583, 2.2167, 2.3750,...
            2.5333, 2.6917, 2.8500, 3.0083, 3.1667, 3.3250, 3.4833, 3.6417,...
            3.8000, 3.9583, 4.1167, 4.2750, 4.4333];
y=[0, 0, 0.2739, 0.1271, 0.1182, 0.0003, 0, 0.8261, 1.0283, 1.3701, 1.3939,...
            1.4834, 1.4768, 1.5338, 1.5669, 1.6099, 1.5984, 1.7197, 1.5892, 1.6701, 1.7373,...
            1.7350, 1.7080, 1.7162, 1.6490, 1.5739, 1.6806, 1.7140, 1.6608];

T10=1;
Dose=0.2;

%orton AIF (offset)
AIF = [2.6579, 1.5163, 22.4028, 0.2351, 0.9500];
[p1,q1,r1]=curve2mex_OrtonOff(t, y, [R1 R2 dce_flip_angle dce_TR dce_TE Dose], AIF, T10);

%weinmann AIF (offset)
AIF = [9.2 4.2 2.3 0.05 0];
[p2,q2,r2]=curve2mex_WeinOff(t, y, [R1 R2 dce_flip_angle dce_TR dce_TE Dose], AIF, T10);

%weinmann AIF (offset + vp)
AIF = [9.2 4.2 2.3 0.05 0];
[p3,q3,r3]=curve2mex_WeinOffVp(t, y, [R1 R2 dce_flip_angle dce_TR dce_TE Dose], AIF, T10);

figure(1);
plot(t, y, '.')
hold on;
plot(t, q1, 'r');
plot(t, q2, 'g');
plot(t, q3, 'b');
hold off;



